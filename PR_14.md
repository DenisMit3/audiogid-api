# PR 14: AI Narration Generation Foundation

## CONTEXT PACK
A) **Nonâ€‘negotiables**: RU-only; on-device Whisper only; **server-confirm only**; **offline-first**; **NO STUBS**.
B) **Current scope**:
    *   Add AI Narration Generation logic (placeholder engine + OpenAI/Vercel TTS prep).
    *   Integrate with Vercel Blob storage for audio saving.
    *   Add `generate_narration` job to Async Worker.
C) **Interfaces in play**: `Narration` table, `worker.py`, `Vercel Blob`.
D) **Async reminder**: QStash callback -> Worker -> Generate -> Save URL -> Update DB.

## Implementation Plan
1.  **Config**:
    *   Add `OPENAI_API_KEY` (optional for now) and `AUDIO_PROVIDER` to `config.py`.
2.  **Service**:
    *   Create `apps/api/api/core/narration/service.py`.
    *   Implement `generate_audio_for_poi(poi_id: uuid.UUID)`.
    *   Logic: Fetch POI title/desc -> Send to TTS -> Save to Vercel Blob -> Record in `Narration` table.
3.  **Worker**:
    *   Add `generate_narration` job type to `worker.py`.
4.  **Security**:
    *   Ensure generated audio URLs are passed through `AssetSigner`. (Done in PR 11).

## Verification
*   **PR Build**: Check compilation.
*   **Cloud Verification**: (Requires API Key) Proactively check if job enqueues correctly.
