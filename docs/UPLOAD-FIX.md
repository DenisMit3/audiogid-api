# Проблема загрузки MP3 файлов - Диагностика

## Статус: ТРЕБУЕТСЯ ДЕЙСТВИЕ НА СЕРВЕРЕ

## Корневая причина

Порт **9000** (MinIO хранилище) **закрыт** на сервере Cloud.ru (82.202.159.64).

Когда пользователь загружает файл:
1. ✅ Браузер отправляет файл на Next.js сервер
2. ✅ Next.js получает presigned URL от бэкенда
3. ❌ Next.js пытается загрузить файл на MinIO (82.202.159.64:9000) - **TIMEOUT**

```
ConnectTimeoutError: Connect Timeout Error 
(attempted address: 82.202.159.64:9000, timeout: 10000ms)
code: 'UND_ERR_CONNECT_TIMEOUT'
```

## Решения

### Вариант 1: Открыть порт 9000 (рекомендуется)

В панели управления Cloud.ru:
1. Перейти в настройки сервера 82.202.159.64
2. Открыть раздел "Firewall" / "Группы безопасности"
3. Добавить правило: **TCP порт 9000, входящий, 0.0.0.0/0**
4. Сохранить

После этого загрузка файлов заработает автоматически.

### Вариант 2: Обновить API на сервере

Если нет возможности открыть порт, нужно обновить API чтобы добавить эндпоинт `/admin/media/upload` который загружает файлы напрямую на сервере.

Требуется SSH доступ к серверу:
```bash
ssh user1@82.202.159.64
# Выполнить скрипт:
bash /path/to/update-media-api.sh
```

### Вариант 3: Задеплоить админку на сервер

Если админка будет работать на том же сервере что и MinIO, то `localhost:9000` будет доступен.

## Текущее состояние кода

Код готов к работе. После открытия порта 9000 или обновления API - загрузка заработает без изменений.

## Файлы для деплоя

- `deploy/cloudru/update-media-api.sh` - скрипт обновления API
- `deploy/cloudru/deploy-admin.ps1` - скрипт деплоя админки
- `deploy/cloudru/DEPLOY-ADMIN.md` - инструкция по деплою
